get.covmat.ArAr <- function(x,i){
    covmat <- matrix(rep(0,16),nrow=4)
    rownames(covmat) <- c('Ar39Ar40','Ar36Ar40','Ar39Ar36','Ar40Ar36')
    colnames(covmat) <- rownames(covmat)
    if (x$format == 1){
        covmat['Ar39Ar40','Ar39Ar40'] <- x$x[i,'errAr39Ar40']^2
        covmat['Ar36Ar40','Ar36Ar40'] <- x$x[i,'errAr36Ar40']^2
        covmat['Ar39Ar36','Ar39Ar36'] <- x$x[i,'errAr39Ar36']^2
        covmat['Ar40Ar36','Ar40Ar36'] <- x$x[i,'errAr40Ar36']^2

        covmat['Ar39Ar40','Ar36Ar40'] <- covmat.xzyz(
            x$x[i,'Ar39Ar40'],x$x[i,'errAr39Ar40'],
            x$x[i,'Ar36Ar40'],x$x[i,'errAr36Ar40'],x$x[i,'errAr39Ar36']
        )
        covmat['Ar39Ar40','Ar39Ar36'] <- covmat.zxzy(
            x$x[i,'Ar39Ar40'],x$x[i,'errAr39Ar40'],
            x$x[i,'Ar39Ar36'],x$x[i,'errAr39Ar36'],x$x[i,'errAr40Ar36']            
        )
        covmat['Ar39Ar40','Ar40Ar36'] <- covmat.xzzy(

        )
        covmat['Ar36Ar40','Ar39Ar40'] <- 
        covmat['Ar36Ar40','Ar39Ar36'] <- 
        covmat['Ar36Ar40','Ar40Ar36'] <- 
        covmat['Ar39Ar36','Ar39Ar40'] <- 
        covmat['Ar39Ar36','Ar36Ar40'] <- 
        covmat['Ar39Ar36','Ar40Ar36'] <- 
        covmat['Ar40Ar36','Ar39Ar40'] <- covmat['Ar39Ar40','Ar40Ar36']
        covmat['Ar40Ar36','Ar36Ar40'] <- covmat['Ar36Ar40','Ar40Ar36']
        covmat['Ar40Ar36','Ar39Ar36'] <- covmat['Ar39Ar36','Ar40Ar36']
    }
    covmat
}

get.covmat.xzyz <- function(xz,err.xz,yz,err.yz,err.xy){
    0.5*xz*yz*((err.xz/xz)^2 + (err.yz/yz)^2 - (err.xy/xy)^2)
}

get.covmat.zxzy <- function(zx,err.zx,zy,err.zy,err.xy){
    0.5*zx*zy*((err.zy/zy)^2+(err.zx/zx)^2+(err.xy/xy)^2)
}

get.covmat.xzzy <- function(xz,err.xz,zy,err.zy,err.xy){
    
}
